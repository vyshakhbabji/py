import sys
from Bio.Seq import Seq
from Bio import SeqIO

def read_file(file):
    buf = open(file)
    arrList = list(SeqIO.parse(buf, "fasta"))
    buf.close()
    return [(ele.description, ele.seq.tostring()) for ele in arrList]

def assignment28():
    buff = read_file("/home/sulab/py/rosalind_edta.txt")
    arr1, arr2 = buff[0][1], buff[1][1]
    len1 = len(arr1)
    len2 = len(arr2)
    str1 = "" 
    str2 = ""
    dist=1
    place=1
    mat = [[None for i in range(len2+1)] for j in range(len1+1)]
    for i in xrange(len1+1):
        mat[i][0] = i
    for j in xrange(len2+1):
        mat[0][j] = j
    for i in xrange(1, len1+1):
        for j in xrange(1, len2+1):
            mat[i][j] = min(mat[i][j-1] + dist,mat[i-1][j] + dist,mat[i-1][j-1] + (place if arr1[i-1] != arr2[j-1] else 0))
    
    print mat[-1][-1]
   
    len1,len2 = len(arr1), len(arr2)
    while len1 > 0 and len2 > 0:
        if mat[len1][len2] == mat[len1][len2-1] + dist:
            str1 += '-'
            str2 += arr2[len2-1]
            len2 -= 1
        elif mat[len1][len2] == mat[len1-1][len2] + dist:
            str1 += arr1[len1-1]
            str2 += '-'
            len1 -= 1
        elif mat[len1][len2] == mat[len1-1][len2-1] and arr1[len1-1] == arr2[len2-1]:
            str1 += arr1[len1-1]
            str2 += arr2[len2-1]
            len1 -= 1
            len2 -= 1
        else:
            str1 += arr1[len1-1]
            str2 += arr2[len2-1]
            len1 -= 1
            len2 -= 1
    while len2>0:
        str1 += '-'
        str2 += arr2[len2-1]
        len2 -= 1
    while len1>0:
        str1 += arr1[len1-1]
        str2 += '-'
        len1 -= 1
   
    print(str1[::-1])
    print(str2[::-1])

assignment28()
